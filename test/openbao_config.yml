# Example YAML (new file in repo root for tests)
policies:
  admin:
    hcl_content: |
      path "*" {
        capabilities = ["create", "read", "update", "delete", "list", "sudo"]
      }
  deploy-ca:
    hcl_content: |
      path "pki-intermediate/*" {
        capabilities = ["read", "list"]
      }
      # issue/sign for deploys
      path "pki-intermediate/issue/*" {
        capabilities = ["create", "update"]
      }
      path "pki-intermediate/issue/internal-api" {
        capabilities = ["create", "update"]
      }
      path "pki-intermediate/sign/*" {
        capabilities = ["create", "update"]
      }
      path "pki-intermediate/config/*" {
        capabilities = ["read"]
      }
      path "pki-intermediate/roles/*" {
        capabilities = ["read"]
      }
      # Allow full access to the PKI KV Cache
      path "secret/data/pki_cache/*" {
        capabilities = ["create", "read", "update", "delete", "list"]
      }
      # If using KV version 1, or for listing metadata in KV version 2
      path "secret/metadata/pki_cache/*" {
        capabilities = ["list", "read"]
      }
      path "secret/data/trusted_internal/*" {
        capabilities = ["read"]
      }
      path "secret/metadata/trusted_internal" {
        capabilities = ["list"]
      }
      path "secret/data/trusted_external/*" {
        capabilities = ["read"]
      }
      path "secret/metadata/trusted_external" {
        capabilities = ["list"]
      }
      path "auth/token/lookup*" {
        capabilities = ["read"]
      }
      path "sys/mounts" {
        capabilities = ["read"]
      }
  user:
    hcl_content: |
      path "secret/*" {
        capabilities = ["create", "read", "update", "delete", "list"]
      }
      path "userpass/users/{{identity.entity.name}}" {
        capabilities = ["read"]
      }

users:
  - display_name: test_user
    password: test_password
    policies:
      - user

tokens:
  - display_name: admin
    policies: ["admin"]
    ttl: "87600h"  # 10y, matching CA
  - display_name: deploy-ca
    policies: ["deploy-ca"]
    ttl: "87600h"
  - display_name: test_user
    policies: ["user"]
    ttl: "168h"  # 1w
